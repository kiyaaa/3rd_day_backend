<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„œë²„ ëª¨ë‹ˆí„° - ì—°ê²°ì´</title>
    <link rel="stylesheet" href="shared-styles.css">
    <style>
        body {
            background: #1a1a1a;
            color: #fff;
        }
        .header {
            background: #333;
        }
        .chat-container {
            background: #000;
        }
        .log-entry {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            padding: 2px 10px;
            border-left: 3px solid transparent;
        }
        .log-entry.info { border-left-color: #17a2b8; color: #17a2b8; }
        .log-entry.success { border-left-color: #28a745; color: #28a745; }
        .log-entry.warning { border-left-color: #ffc107; color: #ffc107; }
        .log-entry.error { border-left-color: #dc3545; color: #dc3545; }
        .stats {
            display: flex;
            gap: 20px;
            padding: 15px;
            background: #222;
            border-bottom: 1px solid #444;
        }
        .stat {
            text-align: center;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #28a745;
        }
        .stat-label {
            font-size: 12px;
            color: #888;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="user-avatar" style="background:#ff5722">ğŸ›¡ï¸</div>
        <div class="user-info">
            <h2>ì„œë²„ ëª¨ë‹ˆí„°</h2>
            <div class="status">ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§</div>
        </div>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="stat-value" id="connectedUsers">0</div>
            <div class="stat-label">ì—°ê²°ëœ ì‚¬ìš©ì</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="activeRooms">0</div>
            <div class="stat-label">í™œì„± ì±„íŒ…ë°©</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="totalMessages">0</div>
            <div class="stat-label">ì „ì²´ ë©”ì‹œì§€</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="pendingQuestions">0</div>
            <div class="stat-label">ëŒ€ê¸° ì§ˆë¬¸</div>
        </div>
    </div>

    <div class="chat-container">
        <div class="messages" id="messages" style="font-family: monospace; background: #000;"></div>
    </div>

    <script>
        const API_URL = 'http://localhost:3004/api';
        let stats = {
            connectedUsers: new Set(),
            activeRooms: new Set(),
            totalMessages: 0,
            pendingQuestions: 0
        };

        // ë¡œê·¸ ì¶”ê°€
        function addLog(message, type = 'info') {
            const messagesDiv = document.getElementById('messages');
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry ${type}`;
            
            const timestamp = new Date().toLocaleTimeString('ko-KR');
            logDiv.textContent = `[${timestamp}] ${message}`;
            
            messagesDiv.appendChild(logDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats() {
            document.getElementById('connectedUsers').textContent = stats.connectedUsers.size;
            document.getElementById('activeRooms').textContent = stats.activeRooms.size;
            document.getElementById('totalMessages').textContent = stats.totalMessages;
            document.getElementById('pendingQuestions').textContent = stats.pendingQuestions;
        }

        // WebSocket ì—°ê²° ëª¨ë‹ˆí„°ë§
        function monitorConnections() {
            // EventSourceë¥¼ í†µí•œ ì„œë²„ ì´ë²¤íŠ¸ ìˆ˜ì‹  (ê°€ìƒ)
            addLog('ì„œë²„ ëª¨ë‹ˆí„°ë§ ì‹œì‘', 'info');
            
            // ìƒ˜í”Œ ì´ë²¤íŠ¸ ì‹œë®¬ë ˆì´ì…˜
            const sampleEvents = [
                { delay: 1000, action: () => {
                    stats.connectedUsers.add('Alex Kim');
                    updateStats();
                    addLog('Alex Kim ì—°ê²°ë¨', 'success');
                }},
                { delay: 2000, action: () => {
                    stats.connectedUsers.add('Sarah Lee');
                    updateStats();
                    addLog('Sarah Lee ì—°ê²°ë¨', 'success');
                }},
                { delay: 3000, action: () => {
                    stats.connectedUsers.add('Mike Park');
                    updateStats();
                    addLog('Mike Park ì—°ê²°ë¨', 'success');
                }},
                { delay: 5000, action: () => {
                    stats.pendingQuestions = 1;
                    updateStats();
                    addLog('ìƒˆ ì§ˆë¬¸ ë“±ë¡: React useEffect ë¬´í•œ ë£¨í”„ ë¬¸ì œ', 'warning');
                }},
                { delay: 7000, action: () => {
                    stats.pendingQuestions = 0;
                    updateStats();
                    addLog('ì§ˆë¬¸ ë§¤ì¹­ ì™„ë£Œ', 'success');
                }},
                { delay: 9000, action: () => {
                    stats.activeRooms.add('room-1');
                    updateStats();
                    addLog('ì±„íŒ…ë°© 1 ìƒì„±ë¨', 'info');
                }},
                { delay: 11000, action: () => {
                    stats.totalMessages++;
                    updateStats();
                    addLog('Alex Kim: ì•ˆë…•í•˜ì„¸ìš”! useEffect ë¬´í•œ ë£¨í”„ ë¬¸ì œë¡œ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤.', 'info');
                }},
                { delay: 13000, action: () => {
                    stats.totalMessages++;
                    updateStats();
                    addLog('Sarah Lee: ì•ˆë…•í•˜ì„¸ìš” Alexë‹˜! ì½”ë“œë¥¼ ë³´ì—¬ì£¼ì‹¤ ìˆ˜ ìˆë‚˜ìš”?', 'info');
                }},
                { delay: 15000, action: () => {
                    stats.totalMessages++;
                    updateStats();
                    addLog('Mike Park: ì €ë„ ë„ì™€ë“œë¦´ê²Œìš”!', 'info');
                }}
            ];

            // ì˜ˆì •ëœ ì´ë²¤íŠ¸ ì‹¤í–‰
            sampleEvents.forEach(event => {
                setTimeout(event.action, event.delay);
            });
        }

        // ì‹œì‘
        document.addEventListener('DOMContentLoaded', () => {
            addLog('ì„œë²„ ëª¨ë‹ˆí„° ì´ˆê¸°í™”', 'info');
            monitorConnections();
        });

        // 5ì´ˆë§ˆë‹¤ ìƒíƒœ ì²´í¬ (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” API í˜¸ì¶œ)
        setInterval(() => {
            addLog('í—¬ìŠ¤ ì²´í¬ ìˆ˜í–‰', 'info');
        }, 30000);
    </script>
</body>
</html>